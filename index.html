<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="css/leaflet.css">
    <link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
    <link rel="stylesheet" href="css/qgis2web.css">
    <link rel="stylesheet" href="css/fontawesome-all.min.css">
    <link rel="stylesheet" href="css/leaflet.photon.css">
    <style>
        /* Estilos generales */
        html, body, #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        /* Panel de texto informativo - MEJORADO PARA RESPONSIVIDAD */
        #texto {
            position: fixed;
            bottom: 10px;
            left: 10px;
            right: auto;
            width: 95%;
            max-width: 400px;
            padding: 15px;
            background-color: #ffffff;
            border: 1px solid #ccc;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-align: center;
            font-size: 16px;
            z-index: 9999;
            animation: fadeInUp 1s ease-out;
            transition: all 0.5s ease-out;
        }
        
        @media (min-width: 768px) {
            #texto {
                left: 1%;
                right: auto;
                width: 25%;
                max-width: 400px;
            }
        }
        
        .hidden {
            opacity: 0;
            transform: translateY(20px);
        }
        /* Botón de cierre */
        #cerrarTexto {
            position: absolute;
            top: 8px;
            right: 12px;
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: #777;
        }
        
        #cerrarTexto:hover {
            color: #333;
        }
        .logo-container {
            margin-bottom: 0.5rem;
        }
        #logo {
            width: 60%;
            max-width: 80px;
            height: auto;
        }
        /* Panel del gráfico - MEJORADO PARA RESPONSIVIDAD Y TAMAÑO */
        #chartPanel {
            position: fixed;
            bottom: 10px;
            right: 10px;
            width: 95%;
            max-width: 350px; /* Reducido */
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            padding: 15px;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        @media (min-width: 768px) {
            #chartPanel {
                width: 28%; /* Ajuste para pantallas grandes */
                max-width: 350px; /* Reducido */
            }
        }
        
        #toggleChart {
            display: block; /* Muestra el botón */
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1001;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 5px 10px;
            font-size: 14px;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        #chartTitle {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 14px; /* Reducido */
        }
        
        .chart-container {
            position: relative;
            height: 200px; /* Reducido */
            width: 100%;
        }

        .tick text {
            font-size: 10px; /* Ajuste para etiquetas de eje */
        }
        
        .bar-label {
            font-size: 10px; /* Ajuste para etiquetas de barra */
            fill: #333;
        }
        
        /* Leyenda de la tabla - MEJORADA PARA MÓVILES */
        .legend-table {
            width: 100%;
            margin-top: 15px;
            border-collapse: collapse;
            font-size: 12px;
        }
        
        .legend-table th {
            background-color: #f5f5f5;
            padding: 5px;
            text-align: left;
        }
        
        .legend-table td {
            padding: 5px;
            border-bottom: 1px solid #eee;
        }
        
        .legend-color {
            display: inline-block;
            width: 12px;
            height: 12px;
            margin-right: 5px;
            border-radius: 2px;
        }

        /* ESTILOS DEL POPUP - MODIFICADOS PARA SER MÁS COMPACTOS */
        .popup-table {
            width: 100%;
            border-collapse: collapse;
            font-family: "Segoe UI", sans-serif;
            font-size: 12px; /* Ligeramente reducido */
            color: #333;
        }

        .popup-table th {
            text-align: left;
            font-weight: 600;
            padding: 4px 6px; /* Reducido */
            background-color: #f0f4f8;
            color: #0078D7;
            border-bottom: 1px solid #ddd;
            width: 40%;
        }

        .popup-table td {
            padding: 4px 6px; /* Reducido */
            border-bottom: 1px solid #eee;
            word-break: break-word;
        }
    </style>
    <title>Mapa de Proyectos</title>
</head>
<body>
    <div id="map">
        <div id="texto">
            <button id="cerrarTexto">✕</button>
            <div class="logo-container">
                <a href="http://mapas.municoquimbo.cl/" target="_blank">
                    <img id="logo" src="images/logo.png" alt="Logo Municipalidad de Coquimbo">
                </a>
            </div>
            <strong>
                <br>
                <span style="font-size: 18px;">Proyectos Municipales 2021-2025</span><br>
                Ilustre Municipalidad de Coquimbo<br><br>
            </strong>
        </div>
        
        <div id="chartPanel">
            <h4 id="chartTitle">Proyectos por Temática</h4>
            <div id="barChartContainer"></div>
        </div>
    </div>
    <script src="js/qgis2web_expressions.js"></script>
    <script src="js/leaflet.js"></script>
    <script src="js/L.Control.Layers.Tree.min.js"></script>
    <script src="js/leaflet-svg-shape-markers.min.js"></script>
    <script src="js/leaflet.rotatedMarker.js"></script>
    <script src="js/leaflet.pattern.js"></script>
    <script src="js/leaflet-hash.js"></script>
    <script src="js/Autolinker.min.js"></script>
    <script src="js/rbush.min.js"></script>
    <script src="js/labelgun.min.js"></script>
    <script src="js/labels.js"></script>
    <script src="js/leaflet.photon.js"></script>
    
    <script src="data/SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2.js"></script>
    <script src="data/SALUDYBIENESTAR_3.js"></script>
    <script src="data/ESPACIOSPUBLICOSYAREASVERDES_4.js"></script>
    <script src="data/INFRAESTRUCTURAURBANAYVIAL_5.js"></script>
    <script src="data/ADULTOMAYORYACCESIBILIDAD_6.js"></script>
    <script src="data/DESARROLLOPRODUCTIVOYTURISMO_7.js"></script>
    <script src="data/ENERGIAYELECTRICIDAD_8.js"></script>
    <script src="data/EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9.js"></script>
    <script src="data/PROYECTOS2021_10.js"></script>
    <script src="data/PROYECTOS2022_11.js"></script>
    <script src="data/PROYECTOS2023_12.js"></script>
    <script src="data/PROYECTOS2024_13.js"></script>
    <script src="data/PROYECTOS2025_14.js"></script>
    <script src="data/ProyectosEjecutados20212025_15.js"></script>
    
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <script>
        var map = L.map('map', {
            zoomControl: false, maxZoom: 28, minZoom: 1
        }).fitBounds([[-30.01648877193584, -71.37590360245304], [-29.92378802736024, -71.21192227222333]]);
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://qgis.org">QGIS</a>');
        var autolinker = new Autolinker({ truncate: { length: 30, location: 'smart' } });
        
        function removeEmptyRowsFromPopupContent(content, feature) {
            var tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            var rows = tempDiv.querySelectorAll('tr');
            for (var i = 0; i < rows.length; i++) {
                var td = rows[i].querySelector('td.visible-with-data');
                var key = td ? td.id : '';
                if (td && td.classList.contains('visible-with-data') && feature.properties[key] == null) {
                    rows[i].parentNode.removeChild(rows[i]);
                }
            }
            return tempDiv.innerHTML;
        }
        function addClassToPopupIfMedia(content, popup) {
            var tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            if (tempDiv.querySelector('td img')) {
                popup._contentNode.classList.add('media');
                setTimeout(function () {
                    popup.update();
                }, 10);
            } else {
                popup._contentNode.classList.remove('media');
            }
        }
        var zoomControl = L.control.zoom({
            position: 'topleft'
        }).addTo(map);
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
        }
        map.createPane('pane_OpenStreetMap_0');
        map.getPane('pane_OpenStreetMap_0').style.zIndex = 400;
        var layer_OpenStreetMap_0 = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            pane: 'pane_OpenStreetMap_0',
            opacity: 1.0,
            attribution: '',
            minZoom: 1,
            maxZoom: 28,
            minNativeZoom: 0,
            maxNativeZoom: 19
        });
        layer_OpenStreetMap_0;
        map.addLayer(layer_OpenStreetMap_0);
        map.createPane('pane_GoogleSatelite_1');
        map.getPane('pane_GoogleSatelite_1').style.zIndex = 401;
        var layer_GoogleSatelite_1 = L.tileLayer('http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}', {
            pane: 'pane_GoogleSatelite_1',
            opacity: 1.0,
            attribution: '',
            minZoom: 1,
            maxZoom: 28,
            minNativeZoom: 0,
            maxNativeZoom: 18
        });
        layer_GoogleSatelite_1;
        //map.addLayer(layer_GoogleSatelite_1);
        function pop_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2_0(feature, latlng) {
            return L.marker(latlng, {
                icon: L.icon({
                    iconUrl: 'images/emergencia.png',
                    iconSize: [20, 20],
                    iconAnchor: [16, 32],
                    popupAnchor: [0, -32]
                }),
                pane: 'pane_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2',
                interactive: true
            });
        }
        map.createPane('pane_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2');
        map.getPane('pane_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2').style.zIndex = 402;
        map.getPane('pane_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2').style['mix-blend-mode'] = 'normal';
        var layer_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2 = new L.geoJson(json_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2, {
            attribution: '',
            interactive: true,
            dataVar: 'json_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2',
            layerName: 'layer_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2',
            pane: 'pane_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2',
            onEachFeature: pop_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2,
            pointToLayer: style_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2_0
        });
        bounds_group.addLayer(layer_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2);
        //map.addLayer(layer_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2);
        function pop_SALUDYBIENESTAR_3(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_SALUDYBIENESTAR_3_0(feature, latlng) {
            return L.marker(latlng, {
                icon: L.icon({
                    iconUrl: 'images/salud.png',
                    iconSize: [20, 20],
                    iconAnchor: [16, 32],
                    popupAnchor: [0, -32]
                }),
                pane: 'pane_SALUDYBIENESTAR_3',
                interactive: true
            });
        }
        map.createPane('pane_SALUDYBIENESTAR_3');
        map.getPane('pane_SALUDYBIENESTAR_3').style.zIndex = 403;
        map.getPane('pane_SALUDYBIENESTAR_3').style['mix-blend-mode'] = 'normal';
        var layer_SALUDYBIENESTAR_3 = new L.geoJson(json_SALUDYBIENESTAR_3, {
            attribution: '',
            interactive: true,
            dataVar: 'json_SALUDYBIENESTAR_3',
            layerName: 'layer_SALUDYBIENESTAR_3',
            pane: 'pane_SALUDYBIENESTAR_3',
            onEachFeature: pop_SALUDYBIENESTAR_3,
            pointToLayer: style_SALUDYBIENESTAR_3_0
        });
        bounds_group.addLayer(layer_SALUDYBIENESTAR_3);
        //map.addLayer(layer_SALUDYBIENESTAR_3);
        function pop_ESPACIOSPUBLICOSYAREASVERDES_4(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_ESPACIOSPUBLICOSYAREASVERDES_4_0(feature, latlng) {
            return L.marker(latlng, {
                icon: L.icon({
                    iconUrl: 'images/espacios publicos.png',
                    iconSize: [20, 20],
                    iconAnchor: [16, 32],
                    popupAnchor: [0, -32]
                }),
                pane: 'pane_ESPACIOSPUBLICOSYAREASVERDES_4',
                interactive: true
            });
        }
        map.createPane('pane_ESPACIOSPUBLICOSYAREASVERDES_4');
        map.getPane('pane_ESPACIOSPUBLICOSYAREASVERDES_4').style.zIndex = 404;
        map.getPane('pane_ESPACIOSPUBLICOSYAREASVERDES_4').style['mix-blend-mode'] = 'normal';
        var layer_ESPACIOSPUBLICOSYAREASVERDES_4 = new L.geoJson(json_ESPACIOSPUBLICOSYAREASVERDES_4, {
            attribution: '',
            interactive: true,
            dataVar: 'json_ESPACIOSPUBLICOSYAREASVERDES_4',
            layerName: 'layer_ESPACIOSPUBLICOSYAREASVERDES_4',
            pane: 'pane_ESPACIOSPUBLICOSYAREASVERDES_4',
            onEachFeature: pop_ESPACIOSPUBLICOSYAREASVERDES_4,
            pointToLayer: style_ESPACIOSPUBLICOSYAREASVERDES_4_0
        });
        bounds_group.addLayer(layer_ESPACIOSPUBLICOSYAREASVERDES_4);
        //map.addLayer(layer_ESPACIOSPUBLICOSYAREASVERDES_4);
        function pop_INFRAESTRUCTURAURBANAYVIAL_5(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_INFRAESTRUCTURAURBANAYVIAL_5_0(feature, latlng) {
            return L.marker(latlng, {
                icon: L.icon({
                    iconUrl: 'images/infraestructura.png',
                    iconSize: [20, 20],
                    iconAnchor: [16, 32],
                    popupAnchor: [0, -32]
                }),
                pane: 'pane_INFRAESTRUCTURAURBANAYVIAL_5',
                interactive: true
            });
        }
        map.createPane('pane_INFRAESTRUCTURAURBANAYVIAL_5');
        map.getPane('pane_INFRAESTRUCTURAURBANAYVIAL_5').style.zIndex = 405;
        map.getPane('pane_INFRAESTRUCTURAURBANAYVIAL_5').style['mix-blend-mode'] = 'normal';
        var layer_INFRAESTRUCTURAURBANAYVIAL_5 = new L.geoJson(json_INFRAESTRUCTURAURBANAYVIAL_5, {
            attribution: '',
            interactive: true,
            dataVar: 'json_INFRAESTRUCTURAURBANAYVIAL_5',
            layerName: 'layer_INFRAESTRUCTURAURBANAYVIAL_5',
            pane: 'pane_INFRAESTRUCTURAURBANAYVIAL_5',
            onEachFeature: pop_INFRAESTRUCTURAURBANAYVIAL_5,
            pointToLayer: style_INFRAESTRUCTURAURBANAYVIAL_5_0
        });
        bounds_group.addLayer(layer_INFRAESTRUCTURAURBANAYVIAL_5);
        //map.addLayer(layer_INFRAESTRUCTURAURBANAYVIAL_5);
        function pop_ADULTOMAYORYACCESIBILIDAD_6(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_ADULTOMAYORYACCESIBILIDAD_6_0(feature, latlng) {
            return L.marker(latlng, {
                icon: L.icon({
                    iconUrl: 'images/anciano.png',
                    iconSize: [20, 20],
                    iconAnchor: [16, 32],
                    popupAnchor: [0, -32]
                }),
                pane: 'pane_ADULTOMAYORYACCESIBILIDAD_6',
                interactive: true
            });
        }
        map.createPane('pane_ADULTOMAYORYACCESIBILIDAD_6');
        map.getPane('pane_ADULTOMAYORYACCESIBILIDAD_6').style.zIndex = 406;
        map.getPane('pane_ADULTOMAYORYACCESIBILIDAD_6').style['mix-blend-mode'] = 'normal';
        var layer_ADULTOMAYORYACCESIBILIDAD_6 = new L.geoJson(json_ADULTOMAYORYACCESIBILIDAD_6, {
            attribution: '',
            interactive: true,
            dataVar: 'json_ADULTOMAYORYACCESIBILIDAD_6',
            layerName: 'layer_ADULTOMAYORYACCESIBILIDAD_6',
            pane: 'pane_ADULTOMAYORYACCESIBILIDAD_6',
            onEachFeature: pop_ADULTOMAYORYACCESIBILIDAD_6,
            pointToLayer: style_ADULTOMAYORYACCESIBILIDAD_6_0
        });
        bounds_group.addLayer(layer_ADULTOMAYORYACCESIBILIDAD_6);
        //map.addLayer(layer_ADULTOMAYORYACCESIBILIDAD_6);
        function pop_DESARROLLOPRODUCTIVOYTURISMO_7(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_DESARROLLOPRODUCTIVOYTURISMO_7_0(feature, latlng) {
            return L.marker(latlng, {
                icon: L.icon({
                    iconUrl: 'images/desarrollo.png',
                    iconSize: [20, 20],
                    iconAnchor: [16, 32],
                    popupAnchor: [0, -32]
                }),
                pane: 'pane_DESARROLLOPRODUCTIVOYTURISMO_7',
                interactive: true
            });
        }
        map.createPane('pane_DESARROLLOPRODUCTIVOYTURISMO_7');
        map.getPane('pane_DESARROLLOPRODUCTIVOYTURISMO_7').style.zIndex = 407;
        map.getPane('pane_DESARROLLOPRODUCTIVOYTURISMO_7').style['mix-blend-mode'] = 'normal';
        var layer_DESARROLLOPRODUCTIVOYTURISMO_7 = new L.geoJson(json_DESARROLLOPRODUCTIVOYTURISMO_7, {
            attribution: '',
            interactive: true,
            dataVar: 'json_DESARROLLOPRODUCTIVOYTURISMO_7',
            layerName: 'layer_DESARROLLOPRODUCTIVOYTURISMO_7',
            pane: 'pane_DESARROLLOPRODUCTIVOYTURISMO_7',
            onEachFeature: pop_DESARROLLOPRODUCTIVOYTURISMO_7,
            pointToLayer: style_DESARROLLOPRODUCTIVOYTURISMO_7_0
        });
        bounds_group.addLayer(layer_DESARROLLOPRODUCTIVOYTURISMO_7);
        //map.addLayer(layer_DESARROLLOPRODUCTIVOYTURISMO_7);
        function pop_ENERGIAYELECTRICIDAD_8(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_ENERGIAYELECTRICIDAD_8_0(feature, latlng) {
            return L.marker(latlng, {
                icon: L.icon({
                    iconUrl: 'images/energia.png',
                    iconSize: [20, 20],
                    iconAnchor: [16, 32],
                    popupAnchor: [0, -32]
                }),
                pane: 'pane_ENERGIAYELECTRICIDAD_8',
                interactive: true
            });
        }
        map.createPane('pane_ENERGIAYELECTRICIDAD_8');
        map.getPane('pane_ENERGIAYELECTRICIDAD_8').style.zIndex = 408;
        map.getPane('pane_ENERGIAYELECTRICIDAD_8').style['mix-blend-mode'] = 'normal';
        var layer_ENERGIAYELECTRICIDAD_8 = new L.geoJson(json_ENERGIAYELECTRICIDAD_8, {
            attribution: '',
            interactive: true,
            dataVar: 'json_ENERGIAYELECTRICIDAD_8',
            layerName: 'layer_ENERGIAYELECTRICIDAD_8',
            pane: 'pane_ENERGIAYELECTRICIDAD_8',
            onEachFeature: pop_ENERGIAYELECTRICIDAD_8,
            pointToLayer: style_ENERGIAYELECTRICIDAD_8_0
        });
        bounds_group.addLayer(layer_ENERGIAYELECTRICIDAD_8);
        //map.addLayer(layer_ENERGIAYELECTRICIDAD_8);
        function pop_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9_0(feature, latlng) {
            return L.marker(latlng, {
                icon: L.icon({
                    iconUrl: 'images/equipamiento.png',
                    iconSize: [20, 20],
                    iconAnchor: [16, 32],
                    popupAnchor: [0, -32]
                }),
                pane: 'pane_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9',
                interactive: true
            });
        }
        map.createPane('pane_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9');
        map.getPane('pane_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9').style.zIndex = 409;
        map.getPane('pane_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9').style['mix-blend-mode'] = 'normal';
        var layer_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9 = new L.geoJson(json_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9, {
            attribution: '',
            interactive: true,
            dataVar: 'json_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9',
            layerName: 'layer_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9',
            pane: 'pane_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9',
            onEachFeature: pop_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9,
            pointToLayer: style_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9_0
        });
        bounds_group.addLayer(layer_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9);
        //map.addLayer(layer_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9);
        function pop_PROYECTOS2021_10(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">AÑO</th><td>${p.AÑO !== null ? autolinker.link(String(p.AÑO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_PROYECTOS2021_10_0() {
            return {
                pane: 'pane_PROYECTOS2021_10',
                radius: 6.0,
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(77,166,255,1.0)',
                interactive: true,
            }
        }
        map.createPane('pane_PROYECTOS2021_10');
        map.getPane('pane_PROYECTOS2021_10').style.zIndex = 410;
        map.getPane('pane_PROYECTOS2021_10').style['mix-blend-mode'] = 'normal';
        var layer_PROYECTOS2021_10 = new L.geoJson(json_PROYECTOS2021_10, {
            attribution: '',
            interactive: true,
            dataVar: 'json_PROYECTOS2021_10',
            layerName: 'layer_PROYECTOS2021_10',
            pane: 'pane_PROYECTOS2021_10',
            onEachFeature: pop_PROYECTOS2021_10,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.circleMarker(latlng, style_PROYECTOS2021_10_0(feature));
            },
        });
        bounds_group.addLayer(layer_PROYECTOS2021_10);
        //map.addLayer(layer_PROYECTOS2021_10);
        function pop_PROYECTOS2022_11(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">AÑO</th><td>${p.AÑO !== null ? autolinker.link(String(p.AÑO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_PROYECTOS2022_11_0() {
            return {
                pane: 'pane_PROYECTOS2022_11',
                shape: 'diamond',
                radius: 8.0,
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(255,153,102,1.0)',
                interactive: true,
            }
        }
        map.createPane('pane_PROYECTOS2022_11');
        map.getPane('pane_PROYECTOS2022_11').style.zIndex = 411;
        map.getPane('pane_PROYECTOS2022_11').style['mix-blend-mode'] = 'normal';
        var layer_PROYECTOS2022_11 = new L.geoJson(json_PROYECTOS2022_11, {
            attribution: '',
            interactive: true,
            dataVar: 'json_PROYECTOS2022_11',
            layerName: 'layer_PROYECTOS2022_11',
            pane: 'pane_PROYECTOS2022_11',
            onEachFeature: pop_PROYECTOS2022_11,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.shapeMarker(latlng, style_PROYECTOS2022_11_0(feature));
            },
        });
        bounds_group.addLayer(layer_PROYECTOS2022_11);
        //map.addLayer(layer_PROYECTOS2022_11);
        function pop_PROYECTOS2023_12(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA !== null ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI !== null ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO !== null ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL !== null ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO !== null ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO !== null ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA !== null ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">AÑO</th><td>${p.AÑO !== null ? autolinker.link(String(p.AÑO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_PROYECTOS2023_12_0() {
            return {
                pane: 'pane_PROYECTOS2023_12',
                shape: 'square',
                radius: 4.0,
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(255,204,51,1.0)',
                interactive: true,
            }
        }
        map.createPane('pane_PROYECTOS2023_12');
        map.getPane('pane_PROYECTOS2023_12').style.zIndex = 412;
        map.getPane('pane_PROYECTOS2023_12').style['mix-blend-mode'] = 'normal';
        var layer_PROYECTOS2023_12 = new L.geoJson(json_PROYECTOS2023_12, {
            attribution: '',
            interactive: true,
            dataVar: 'json_PROYECTOS2023_12',
            layerName: 'layer_PROYECTOS2023_12',
            pane: 'pane_PROYECTOS2023_12',
            onEachFeature: pop_PROYECTOS2023_12,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.shapeMarker(latlng, style_PROYECTOS2023_12_0(feature));
            },
        });
        bounds_group.addLayer(layer_PROYECTOS2023_12);
        //map.addLayer(layer_PROYECTOS2023_12);
        function pop_PROYECTOS2024_13(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">AÑO</th><td>${p.AÑO ? autolinker.link(String(p.AÑO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_PROYECTOS2024_13_0() {
            return {
                pane: 'pane_PROYECTOS2024_13',
                shape: 'triangle',
                radius: 6.0,
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(102,204,102,1.0)',
                interactive: true,
            }
        }
        map.createPane('pane_PROYECTOS2024_13');
        map.getPane('pane_PROYECTOS2024_13').style.zIndex = 413;
        map.getPane('pane_PROYECTOS2024_13').style['mix-blend-mode'] = 'normal';
        var layer_PROYECTOS2024_13 = new L.geoJson(json_PROYECTOS2024_13, {
            attribution: '',
            interactive: true,
            dataVar: 'json_PROYECTOS2024_13',
            layerName: 'layer_PROYECTOS2024_13',
            pane: 'pane_PROYECTOS2024_13',
            onEachFeature: pop_PROYECTOS2024_13,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.shapeMarker(latlng, style_PROYECTOS2024_13_0(feature));
            },
        });
        bounds_group.addLayer(layer_PROYECTOS2024_13);
        //map.addLayer(layer_PROYECTOS2024_13);
        function pop_PROYECTOS2025_14(feature, layer) {
            var p = feature.properties;
            var popupContent = `<table class="popup-table">
            <tr><th scope="row">INICIATIVA</th><td>${p.INICIATIVA ? autolinker.link(String(p.INICIATIVA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">FINANCIAMI</th><td>${p.FINANCIAMI ? autolinker.link(String(p.FINANCIAMI).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">EXTERNO</th><td>${p.EXTERNO ? autolinker.link(String(p.EXTERNO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MUNICIPAL</th><td>${p.MUNICIPAL ? autolinker.link(String(p.MUNICIPAL).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">MONTO</th><td>${p.MONTO ? autolinker.link(String(p.MONTO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">ESTADO</th><td>${p.ESTADO ? autolinker.link(String(p.ESTADO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">TEMATICA</th><td>${p.TEMATICA ? autolinker.link(String(p.TEMATICA).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            <tr><th scope="row">AÑO</th><td>${p.AÑO ? autolinker.link(String(p.AÑO).replace(/'/g, "'").toLocaleString()) : ''}</td></tr>
            </table>`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_PROYECTOS2025_14_0() {
            return {
                pane: 'pane_PROYECTOS2025_14',
                radius: 8.0,
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(255,77,77,1.0)',
                interactive: true,
            }
        }
        map.createPane('pane_PROYECTOS2025_14');
        map.getPane('pane_PROYECTOS2025_14').style.zIndex = 414;
        map.getPane('pane_PROYECTOS2025_14').style['mix-blend-mode'] = 'normal';
        var layer_PROYECTOS2025_14 = new L.geoJson(json_PROYECTOS2025_14, {
            attribution: '',
            interactive: true,
            dataVar: 'json_PROYECTOS2025_14',
            layerName: 'layer_PROYECTOS2025_14',
            pane: 'pane_PROYECTOS2025_14',
            onEachFeature: pop_PROYECTOS2025_14,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.shapeMarker(latlng, style_PROYECTOS2025_14_0(feature));
            },
        });
        bounds_group.addLayer(layer_PROYECTOS2025_14);
        //map.addLayer(layer_PROYECTOS2025_14);
        function pop_ProyectosEjecutados20212025_15(feature, layer) {
            var popupContent = `
                <table class="popup-table">
                    <tr><th>Iniciativa</th><td>${feature.properties['INICIATIVA'] ? autolinker.link(String(feature.properties['INICIATIVA'])) : ''}</td></tr>
                    <tr><th>Financiamiento</th><td>${feature.properties['FINANCIAMI'] ? autolinker.link(String(feature.properties['FINANCIAMI'])) : ''}</td></tr>
                    <tr><th>Externo</th><td>${feature.properties['EXTERNO'] ? autolinker.link(String(feature.properties['EXTERNO'])) : ''}</td></tr>
                    <tr><th>Municipal</th><td>${feature.properties['MUNICIPAL'] ? autolinker.link(String(feature.properties['MUNICIPAL'])) : ''}</td></tr>
                    <tr><th>Monto</th><td>${feature.properties['MONTO'] ? autolinker.link(String(feature.properties['MONTO'])) : ''}</td></tr>
                    <tr><th>Estado</th><td>${feature.properties['ESTADO'] ? autolinker.link(String(feature.properties['ESTADO'])) : ''}</td></tr>
                    <tr><th>Temática</th><td>${feature.properties['TEMATICA'] ? autolinker.link(String(feature.properties['TEMATICA'])) : ''}</td></tr>
                    <tr><th>Año</th><td>${feature.properties['AÑO'] ? autolinker.link(String(feature.properties['AÑO'])) : ''}</td></tr>
                </table>
`;
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
            layer.on('popupopen', function (e) {
                addClassToPopupIfMedia(content, e.popup);
            });
            layer.bindPopup(content, { maxHeight: 400 });
        }
        function style_ProyectosEjecutados20212025_15_0() {
            return {
                pane: 'pane_ProyectosEjecutados20212025_15',
                radius: 5.999999999999998,
                opacity: 1,
                color: 'rgba(255,255,255,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 2.0,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(84,176,74,1.0)',
                interactive: true,
            }
        }
        map.createPane('pane_ProyectosEjecutados20212025_15');
        map.getPane('pane_ProyectosEjecutados20212025_15').style.zIndex = 415;
        map.getPane('pane_ProyectosEjecutados20212025_15').style['mix-blend-mode'] = 'normal';
        var layer_ProyectosEjecutados20212025_15 = new L.geoJson(json_ProyectosEjecutados20212025_15, {
            attribution: '',
            interactive: true,
            dataVar: 'json_ProyectosEjecutados20212025_15',
            layerName: 'layer_ProyectosEjecutados20212025_15',
            pane: 'pane_ProyectosEjecutados20212025_15',
            onEachFeature: pop_ProyectosEjecutados20212025_15,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.circleMarker(latlng, style_ProyectosEjecutados20212025_15_0(feature));
            },
        });
        bounds_group.addLayer(layer_ProyectosEjecutados20212025_15);
        map.addLayer(layer_ProyectosEjecutados20212025_15);
        var overlaysTree = [
            { label: '<img src="legend/ProyectosEjecutados20212025_15.png" /> Proyectos Ejecutados 2021-2025', layer: layer_ProyectosEjecutados20212025_15 },
            {
                label: '<b>Proyectos por Año</b>', selectAllCheckbox: true, children: [
                    { label: '<img src="legend/PROYECTOS2025_14.png" /> PROYECTOS 2025', layer: layer_PROYECTOS2025_14 },
                    { label: '<img src="legend/PROYECTOS2024_13.png" /> PROYECTOS 2024', layer: layer_PROYECTOS2024_13 },
                    { label: '<img src="legend/PROYECTOS2023_12.png" /> PROYECTOS 2023', layer: layer_PROYECTOS2023_12 },
                    { label: '<img src="legend/PROYECTOS2022_11.png" /> PROYECTOS 2022', layer: layer_PROYECTOS2022_11 },
                    { label: '<img src="legend/PROYECTOS2021_10.png" /> PROYECTOS 2021', layer: layer_PROYECTOS2021_10 },
                ]
            },
            {
                label: '<b>Proyectos por Temática</b>', selectAllCheckbox: true, children: [
                    { label: '<img src="legend/EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9.png" /> EQUIPAMIENTO COMUNITARIO Y EDIFICIOS PUBLICOS', layer: layer_EQUIPAMIENTOCOMUNITARIOYEDIFICIOSPUBLICOS_9 },
                    { label: '<img src="legend/ENERGIAYELECTRICIDAD_8.png" /> ENERGIA Y ELECTRICIDAD', layer: layer_ENERGIAYELECTRICIDAD_8 },
                    { label: '<img src="legend/DESARROLLOPRODUCTIVOYTURISMO_7.png" /> DESARROLLO PRODUCTIVO Y TURISMO', layer: layer_DESARROLLOPRODUCTIVOYTURISMO_7 },
                    { label: '<img src="legend/ADULTOMAYORYACCESIBILIDAD_6.png" /> ADULTO MAYOR Y ACCESIBILIDAD', layer: layer_ADULTOMAYORYACCESIBILIDAD_6 },
                    { label: '<img src="legend/INFRAESTRUCTURAURBANAYVIAL_5.png" /> INFRAESTRUCTURA URBANA Y VIAL', layer: layer_INFRAESTRUCTURAURBANAYVIAL_5 },
                    { label: '<img src="legend/ESPACIOSPUBLICOSYAREASVERDES_4.png" /> ESPACIOS PUBLICOS Y AREAS VERDES', layer: layer_ESPACIOSPUBLICOSYAREASVERDES_4 },
                    { label: '<img src="legend/SALUDYBIENESTAR_3.png" /> SALUD Y BIENESTAR', layer: layer_SALUDYBIENESTAR_3 },
                    { label: '<img src="legend/SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2.png" /> SEGURIDAD, EMERGENCIA Y SERVICIOS PUBLICOS', layer: layer_SEGURIDADEMERGENCIAYSERVICIOSPUBLICOS_2 },
                ]
            },
            { label: "Google Satelite", layer: layer_GoogleSatelite_1 },
            { label: "OpenStreetMap", layer: layer_OpenStreetMap_0 },]
        var lay = L.control.layers.tree(null, overlaysTree, {
            collapsed: true
        });
        lay.addTo(map);
        document.addEventListener("DOMContentLoaded", function () {
            function newLayersListHeight() {
                var layerScrollbarElement = document.querySelector('.leaflet-control-layers-scrollbar');
                if (layerScrollbarElement) {
                    var layersListElement = document.querySelector('.leaflet-control-layers-list');
                    var originalHeight = layersListElement.style.height
                        || window.getComputedStyle(layersListElement).height;
                    var newHeight = parseFloat(originalHeight) - 50;
                    layersListElement.style.height = newHeight + 'px';
                }
            }
            var isLayersListExpanded = true;
            var controlLayersElement = document.querySelector('.leaflet-control-layers');
            var toggleLayerControl = document.querySelector('.leaflet-control-layers-toggle');
            toggleLayerControl.addEventListener('click', function () {
                if (isLayersListExpanded) {
                    controlLayersElement.classList.remove('leaflet-control-layers-expanded');
                } else {
                    controlLayersElement.classList.add('leaflet-control-layers-expanded');
                }
                isLayersListExpanded = !isLayersListExpanded;
                newLayersListHeight()
            });
            if (controlLayersElement) {
                controlLayersElement.addEventListener('click', function (event) {
                    var toggleLayerHeaderPointer = event.target.closest('.leaflet-layerstree-header-pointer span');
                    if (toggleLayerHeaderPointer) {
                        newLayersListHeight();
                    }
                });
            }
            setTimeout(function () {
                toggleLayerControl.click();
            }, 10);
            setTimeout(function () {
                toggleLayerControl.click();
            }, 10);
            var isSmallScreen = window.innerWidth < 650;
            if (isSmallScreen) {
                setTimeout(function () {
                    controlLayersElement.classList.remove('leaflet-control-layers-expanded');
                    isLayersListExpanded = !isLayersListExpanded;
                }, 500);
            }
            const cerrarTextoBtn = document.getElementById('cerrarTexto');
            const textoPanel = document.getElementById('texto');
            if (cerrarTextoBtn && textoPanel) {
                cerrarTextoBtn.addEventListener('click', () => {
                    textoPanel.classList.add('hidden');
                    setTimeout(() => {
                        textoPanel.style.display = 'none';
                    }, 500);
                });
            }
        });
        setBounds();

        // Código para generar el gráfico de barras
        function generateBarChart(data) {
            const container = d3.select("#barChartContainer");
            container.selectAll("*").remove(); // Limpia el contenedor

            const margin = { top: 20, right: 30, bottom: 80, left: 60 }; // Bottom aumentado para etiquetas giradas
            const width = container.node().getBoundingClientRect().width - margin.left - margin.right;
            const height = 250 - margin.top - margin.bottom; // Altura del gráfico reducida

            const svg = container.append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            const x = d3.scaleBand()
                .range([0, width])
                .domain(data.map(d => d.tematica))
                .padding(0.2);

            svg.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x))
                .selectAll("text")
                .attr("transform", "translate(-10,0)rotate(-45)")
                .style("text-anchor", "end")
                .style("font-size", "10px"); // Tamaño de fuente para etiquetas del eje X

            const y = d3.scaleLinear()
                .domain([0, d3.max(data, d => d.cantidad) + 5]) // Pequeño margen superior para los valores de las barras
                .range([height, 0]);

            svg.append("g")
                .call(d3.axisLeft(y).ticks(5)) // Reducir el número de ticks en el eje Y
                .selectAll("text")
                .style("font-size", "10px"); // Tamaño de fuente para etiquetas del eje Y

            // Escala de colores
            const color = d3.scaleOrdinal(d3.schemeCategory10) // Utiliza una paleta de 10 colores categóricos
                .domain(data.map(d => d.tematica));

            svg.selectAll("bar")
                .data(data)
                .enter()
                .append("rect")
                .attr("x", d => x(d.tematica))
                .attr("y", d => y(d.cantidad))
                .attr("width", x.bandwidth())
                .attr("height", d => height - y(d.cantidad))
                .attr("fill", d => color(d.tematica)); // Asigna color según la temática

            svg.selectAll(".bar-label")
                .data(data)
                .enter()
                .append("text")
                .attr("class", "bar-label")
                .attr("x", d => x(d.tematica) + x.bandwidth() / 2)
                .attr("y", d => y(d.cantidad) - 5)
                .attr("text-anchor", "middle")
                .text(d => d.cantidad);
        }

        // Datos de ejemplo
        const chartData = [
            { tematica: "Equipamiento Comunitario", cantidad: 21 },
            { tematica: "Energía y Electricidad", cantidad: 5 },
            { tematica: "Desarrollo Productivo", cantidad: 6 },
            { tematica: "Adulto Mayor y Accesibilidad", cantidad: 4 },
            { tematica: "Infraestructura Vial", cantidad: 125 },
            { tematica: "Espacios Públicos y Áreas Verdes", cantidad: 52 },
            { tematica: "Salud y Bienestar", cantidad: 51 },
            { tematica: "Seguridad y Servicios", cantidad: 8 }
        ];

        // Llama a la función para generar el gráfico con los datos de ejemplo
        generateBarChart(chartData);

    </script>
</body>
</html>